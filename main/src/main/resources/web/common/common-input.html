<link rel="import" href="../bower_components/paper-button/paper-button.html">

<polymer-element name="common-action">
  <template>
    <style>
      :host {
        display: inline-block;
        cursor: pointer;
      }
    </style>
    <content></content>
  </template>
  <script>
    Polymer({
      publish: {
        type: '',
        args: null
      },
      eventDelegates: {
        'tap': 'tapAction'
      },
      tapAction: function (e, detail) {
        if (typeof detail != 'object') {
          detail = {};
        }
        detail.action = this.action;
        detail.actionArgs = this.args;
      }
    });
  </script>
</polymer-element>

<link rel="import" href="common-search.html">

<polymer-element name="common-input-selector" vertical layout>
  <template>
    <section class="selection">
      <content select="template[for='selected']"></content>
    </section>
    <common-search-selector class="area-search" keyprop="{{keyprop}}" multi selected="{{selected}}" selectedBox="{{selectedBox}}">
      <content select="template"></content>
    </common-search-selector>
  </template>
  <script>
    Polymer({
      publish: {
        keyprop: '',
        selected: null
      },
      domReady: function () {
        var arr = this.shadowRoot.querySelectorAll('content');
        var tpl = arr[0].getDistributedNodes()[0] || arr[1].getDistributedNodes()[0];
        if (!tpl) throw new Error('template not found');
        if (tpl.hasAttribute('repeat') || tpl.hasAttribute('bind') || tpl.hasAttribute('if'))
          throw new Error('cannot use template with repeat/if/bind attribute');
        var clone = this.ownerDocument.importNode(tpl, false);
        clone.setAttribute('repeat', '{{selectedBox}}');
        this.$.selected.parentNode.appendChild(clone);
        HTMLTemplateElement.decorate(clone, tpl);
        clone.bindingDelegate = this.element.syntax;
        clone.model = this;
      },
    });
  </script>
</polymer-element>