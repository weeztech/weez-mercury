<link rel="import" href="../bower_components/core-icons/core-icons.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">

<polymer-element name="common-search-input">
  <template>
    <style>
      :host {
        display: inline-block;
      }
      [hide] {
        display: none;
      }
    </style>
    <div horizontal layout center>
      <paper-icon-button icon="search" on-tap="{{searchAction}}"></paper-icon-button>
      <paper-input flex label="{{label}}" value="{{inputValue}}"></paper-input>
      <paper-icon-button icon="clear" on-tap="{{clearAction}}" hide?="{{!inputValue}}"></paper-icon-button>
    </div>
  </template>
  <script>
    Polymer({
      publish: {
        value: '',
        delay: 500,
        label: ''
      },
      inputValue: '',
      inputValueChanged: function () {
        this.job('input', function () {
          this.value = this.inputValue;
        }, this.delay);
      },
      searchAction: function () {
        this.job('input', function () {
          this.value = this.inputValue;
        }, 0);
      },
      clearAction: function () {
        this.inputValue = '';
      }
    });
  </script>
</polymer-element>

<link rel="import" href="common-list.html">

<polymer-element name="common-search-selector" vertical layout>
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <common-search-input label="请输入关键字" value="{{keywords}}"></common-search-input>
    <common-selector id="list" selection="{{selection}}" on-query="{{queryAction}}" flex>
      <content></content>
    </common-selector>
  </template>
  <script>
    Polymer({
      publish: {
        selection: null
      },
      keywordsChanged: function () {
        this.$.list.reload();
      },
      queryAction: function (e, detail) {
        detail.keywords = this.keywords;
      }
    });
  </script>
</polymer-element>
