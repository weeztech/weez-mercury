<link rel="import" href="../common/common-search-input.html">
<link rel="import" href="../common/common-pager.html">
<link rel="import" href="../common/common-selection.html">
<link rel="import" href="../common/common-search-selector.html">
<link rel="import" href="../common/common-link.html">
<link rel="import" href="../common/common-remote.html">

<polymer-element name="app-collection-selector" vertical layout>
  <template>
    <style>
      :host {
        display: block;
      }
      .spinner {
        background-color: rgba(255, 255, 255, 0.3);
      }
    </style>
    <common-search-input value="{{keywords}}"></common-search-input>
    <common-pager id="pager" keywords="{{keywords}}" on-common-query="{{queryAction}}" flex>
      <template>
        <common-link>{{name}}</common-link>
      </template>
    </common-pager>
    <common-selection selected="{{selected}}">
      <common-selector target="{{$.pager}}"></common-selector>
    </common-selection>
  </template>
  <script>
    Polymer({
      publish: {
        selected: null
      },
      queryAction: function (e, detail) {
        detail.result = Weez.remoteCall('debug.DBDebugService.listCollectionMetas', {
          prefix: detail.keywords,
          start: detail.start,
          count: 100
        });
      }
    });
  </script>
</polymer-element>